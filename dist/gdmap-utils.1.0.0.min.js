!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).AMapUtils=e()}(this,function(){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function s(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&n(t,e)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function n(t,e){return(n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?c(t):e}function h(t,e,n){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function e(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function t(t,e){void 0===e&&(e={});var n=e.insertAt;if(t&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===n&&o.firstChild?o.insertBefore(i,o.firstChild):o.appendChild(i),i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t))}}function f(t,e){return void 0===t?e:t}function p(t){var s=[],a=/\d+(\.\d+)?/g;"string"==typeof t?t.split("|").forEach(function(t){if(t){for(var e=[],n=t.match(a),o=1;o<n.length;o+=2){var i=parseFloat(n[o-1]),r=parseFloat(n[o]);e.push([i,r])}s.push(e)}}):console.warn("经纬度格式有误:",t);return s}t(".dcmap-polyrect-container {\n  background-color: red;\n  width: 50px;\n  height: 50px;\n  pointer-events: none; }\n  .dcmap-polyrect-container .text {\n    font-size: 50px; }\n");var _=function(){function e(t){o(this,e),this.__initialize(t||{})}return s(e,[{key:"__initialize",value:function(t){this.__map=null,this.__position=t.position,this.__zIndex=t.zIndex||10,this.__extData=t.extData}},{key:"getPosition",value:function(){return this.__position}},{key:"getOverlays",value:function(){return this.__overlays}},{key:"setOverlays",value:function(t){this.__overlays=t}},{key:"isShow",value:function(){return null!=this.__map}},{key:"setMap",value:function(t){this.__map=t;var e=this.getOverlays();this.__callMethod(e,"setMap",t)}},{key:"getMap",value:function(){return this.__map||null}},{key:"__callMethod",value:function(t,e){for(var n=arguments.length,o=new Array(2<n?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];null!==t&&(Array.isArray(t)?t.forEach(function(t){t[e].apply(t,o)}):"object"===r(t)?t[e].apply(t,o):console.warn("传入值不是实例对象",t))}},{key:"destroy",value:function(){this.setMap(null)}}]),e}();t(".dcmap-normaltext-container {\n  display: flex;\n  justify-content: center;\n  align-items: center; }\n");var y=function(t){function n(t){var e;return o(this,n),(e=u(this,l(n).call(this,t)))._initialize(t||{}),e}return a(n,_),s(n,[{key:"_initialize",value:function(t){this._text=t.text||"",this._textColor=t.textColor||"#fff",this._paddingWidth=t.paddingWidth||20,this._textSize=t.textSize||20,this._paddingHeight=t.paddingHeight||10,this._createMarker(),t.map&&this.setMap(t.map)}},{key:"_createMarker",value:function(){var t=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:20;return t?t.replace(/[^\\x00-\\xff]/g,"aa").length*e/2:0}(this._text,this._textSize)+this._paddingWidth,e=this._textSize+this._paddingHeight,n=this._createElement(e,t);console.log(this.getPosition());var o=new AMap.Marker({position:this.getPosition(),offset:new AMap.Pixel(-t/2,-e/2),content:n,bubble:!0});this.setOverlays(o)}},{key:"_createElement",value:function(t,e){var n=document.createElement("div");return n.className="dcmap-normaltext-container",n.style.width=e+"px",n.style.height=t+"px",n.style.fontSize=this._textSize+"px",n.style.color=this._textColor,n.innerText=this._text,n}}]),n}();return{Polyrect:function(t){function n(t){var e;return o(this,n),(e=u(this,l(n).call(this,t)))._clickHandle=e._clickHandle.bind(c(c(e))),e._mouseOut=e._mouseOut.bind(c(c(e))),e._mouseOver=e._mouseOver.bind(c(c(e))),e._initialize(t||{}),e}return a(n,_),s(n,[{key:"_initialize",value:function(t){this._strokeColor=t.strokeColor||"#f00",this._strokeOpacity=f(t.strokeOpacity,.8),this._strokeWeight=f(t.strokeWeight,1),this._fillColor=t.fillColor||"blue",this._fillOpacity=f(t.fillOpacity,.2),this._isShowText=f(t.isShowText,!0),this._minShowByText=f(t.minShowByText,1),this._text=t.text||"",this._textColor=t.textColor||"#fff",this._textOption=t.textOption||{},this._TextClass=t.textClass||y,this._extData=t.extData,this._click=t.click,this._mouseover=t.mouseover,this._mouseout=t.mouseout,this._useCanvas=f(t.useCanvas,!1),this._canvasDom=t.canvasDom,this._coordinate=p(t.coordinate),this._checkCoordinate=p(t.checkCoordinate||""),this._createCheckPolygon(),this._useCanvas?this._createCustomLayer():(this._createPolygon(),this._overLayGroup=new AMap.OverlayGroup(this._polygons)),t.map&&this.setMap(t.map),this._createText()}},{key:"getOverlays",value:function(){var t=this._checkPolygons||[];return[].concat(e(this._polygons),e(t))}},{key:"setMap",value:function(t){t?(this.__map&&this.__map.off("zoomchange",this._textUpdate,this),h(l(n.prototype),"setMap",this).call(this,t),this.__map.on("zoomchange",this._textUpdate,this)):(this.__map&&this.__map.off("zoomchange",this._textUpdate,this),h(l(n.prototype),"setMap",this).call(this,t)),this._textUpdate()}},{key:"_createText",value:function(){if(this._textObj&&("function"==typeof this._textObj.destroy&&this._text.destroy(),this._text=null),this._TextClass){var t=function(i){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},e=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),e.forEach(function(t){var e,n,o;e=i,o=r[n=t],n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o})}return i}({map:this.getMap(),text:this._text,textColor:this._textColor,position:this.getPosition()},this._textOption);this._textObj=new this._TextClass(t)}else console.warn("未找到文字对象,检查textClass参数",this._TextClass)}},{key:"_textUpdate",value:function(){if(this._textObj)if(this._hasShowText()){var t=this.getMap();this._textObj.setMap(t)}else this._textObj.setMap(null)}},{key:"_hasShowText",value:function(){if(this.isShow()&&this._text&&this.getMap().getZoom()>=this._minShowByText)return!0;return!1}},{key:"hasCheckPolygon",value:function(){return this._checkCoordinate&&0<this._checkCoordinate.length}},{key:"_createCheckPolygon",value:function(){var n=this;this.hasCheckPolygon()&&(1<this._checkCoordinate.length&&console.warn("checkCoordinate建议设置为单区域简单多边形以提高性能"),this._checkPolygons=this._checkCoordinate.map(function(t){var e=new AMap.Polygon({path:t,strokeOpacity:0,strokeWeight:0,fillOpacity:0,zIndex:n.__zIndex+1,bubble:!0});return n._addEvent(e),e}))}},{key:"_createPolygon",value:function(){var n=this,o=this.hasCheckPolygon();this._polygons=this._coordinate.map(function(t){var e=new AMap.Polygon({path:t,strokeColor:n._strokeColor,strokeOpacity:n._strokeOpacity,strokeWeight:n._strokeWeight,fillColor:n._fillColor,fillOpacity:n._fillOpacity,zIndex:n.__zIndex,bubble:!0});return o||n._addEvent(e),e})}},{key:"_addEvent",value:function(t){t.on("mouseover",this._mouseOver),t.on("mouseout",this._mouseOut),t.on("click",this._clickHandle)}},{key:"_mouseOut",value:function(){}},{key:"_mouseOver",value:function(){}},{key:"_clickHandle",value:function(){}},{key:"destroy",value:function(){h(l(n.prototype),"destroy",this).call(this),console.log("子类")}}]),n}(),NormalText:y,Text3D:function(t){function e(){return o(this,e),u(this,l(e).apply(this,arguments))}return a(e,_),s(e,[{key:"setMap",value:function(t){h(l(e.prototype),"setMap",this).call(this,t),console.log("text3d")}}]),e}()}});
